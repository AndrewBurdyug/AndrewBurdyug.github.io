<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Udev Network Rules &#8212; Blog  documentation</title>
    
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about/" />
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
  
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  
  <link rel="alternate" type="application/atom+xml"  href="../blog/atom.xml" title="Blog Blog">
  
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <style type="text/css">
    ul.ablog-archive {list-style: none; overflow: auto; margin-left: 0px}
    ul.ablog-archive li {float: left; margin-right: 5px; font-size: 80%}
    ul.postlist a {font-style: italic;}
    ul.postlist-style-disc {list-style-type: disc;}
    ul.postlist-style-none {list-style-type: none;}
    ul.postlist-style-circle {list-style-type: circle;}
  </style>

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="udev-network-rules">
<h1>Udev Network Rules<a class="headerlink" href="#udev-network-rules" title="Permalink to this headline">¶</a></h1>
<p>For prevent wrong configuration of IPs between ethernet adapters during reboots
you can use <a class="reference external" href="https://en.wikipedia.org/wiki/Udev">udev</a> system.</p>
<div class="section" id="why-is-this-needed">
<h2>Why is this needed?<a class="headerlink" href="#why-is-this-needed" title="Permalink to this headline">¶</a></h2>
<p>I encountered this problem in archlinux, during reboots my network adapters
changed their names and <code class="docutils literal"><span class="pre">netcfg</span></code> profiles did not worked properly. The old eth0(LAN, static IP)
became eth1(WAN, ISP dhcp) and attempted to get IP by dhcp and vice versa: old eth1(WAN, ISP dhcp)
became eth0(LAN, static IP) and not worked in ISP network. Of course configure  eth0(LAN) for using
the local dhcp maybe help, but when network adapters change their names in random order, imho it is a bad thing...</p>
</div>
<div class="section" id="solution">
<h2>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h2>
<p>Use <a class="reference external" href="https://en.wikipedia.org/wiki/Udev">udev</a>. Create a file <code class="docutils literal"><span class="pre">/etc/udev/rules.d/10-network.rules</span></code> with such content:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;net&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">==</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">ATTR</span><span class="p">{</span><span class="n">address</span><span class="p">}</span><span class="o">==</span><span class="s2">&quot;00:11:1b:87:07:01&quot;</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;eth0</span>
<span class="n">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;net&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">==</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">ATTR</span><span class="p">{</span><span class="n">address</span><span class="p">}</span><span class="o">==</span><span class="s2">&quot;00:e0:1c:fe:01:09&quot;</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;eth1</span>
</pre></div>
</div>
<p>where <code class="docutils literal"><span class="pre">30:85:a9:ae:f2:03</span></code> is mac address of eth0 and <code class="docutils literal"><span class="pre">30:85:a2:ae:00:03</span></code> is mac address of
your second ethernet adapter. Now your network adapters will not change their names anymore!</p>
<p>Good, but you can go ahead and do something like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;net&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">==</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">ATTR</span><span class="p">{</span><span class="n">address</span><span class="p">}</span><span class="o">==</span><span class="s2">&quot;00:11:1b:87:07:01&quot;</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;world&quot;</span>
<span class="n">SUBSYSTEM</span><span class="o">==</span><span class="s2">&quot;net&quot;</span><span class="p">,</span> <span class="n">ACTION</span><span class="o">==</span><span class="s2">&quot;add&quot;</span><span class="p">,</span> <span class="n">ATTR</span><span class="p">{</span><span class="n">address</span><span class="p">}</span><span class="o">==</span><span class="s2">&quot;00:e0:1c:fe:01:09&quot;</span><span class="p">,</span> <span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;lan&quot;</span>
</pre></div>
</div>
<p>renamed both adapters to more meaningful names. Now it is not necessary to remember
which of the adapters is looking out to world and which to lan:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">[root@localhost:~]#</span> ifconfig lan
<span class="go">lan: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span>
<span class="go">        inet 192.168.1.1  netmask 255.255.255.0  broadcast 192.168.1.255</span>
<span class="go">        ether 00:e0:1c:fe:01:09  txqueuelen 1000  (Ethernet)</span>
<span class="go">        RX packets 0  bytes 0 (0.0 B)</span>
<span class="go">        RX errors 0  dropped 0  overruns 0  frame 0</span>
<span class="go">        TX packets 0  bytes 0 (0.0 B)</span>
<span class="go">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span>

<span class="gp">[root@localhost:~]#</span> ifconfig world
<span class="go">world: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span>
<span class="go">        inet 178.32.218.104  netmask 255.255.255.0  broadcast 178.32.218.255</span>
<span class="go">        ether 00:11:1b:87:07:01  txqueuelen 1000  (Ethernet)</span>
<span class="go">        RX packets 3462929  bytes 626938389 (597.8 MiB)</span>
<span class="go">        RX errors 0  dropped 497  overruns 0  frame 0</span>
<span class="go">        TX packets 299085  bytes 49491640 (47.1 MiB)</span>
<span class="go">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span>
</pre></div>
</div>
<p>and <code class="docutils literal"><span class="pre">iptables</span></code> rules become looking better:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>-A POSTROUTING -s 192.168.1.0/24 ! -d 192.168.1.0/24 -o world -j SNAT --to-source 178.32.218.104
</pre></div>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<p>Sometimes it is need to look deeper into Linux, its systems like <a class="reference external" href="https://en.wikipedia.org/wiki/Udev">udev</a>. You
will discover a lot of interesting things for themselves =)</p>
</div>
</div>

  <div class="section">
  
    


<div class="section">
  <span style="float: left;">
  
  
  <a href="../mysql-character-set_ru/">
    <i class="fa fa-arrow-circle-left"></i>
    Смена кодировки в MySQL
  </a>
  
  </span>
  <span>&nbsp;</span>
  <span style="float: right;">
  
  
  <a href="../nginx-build-own-deb-package_ru/">
    Сборка Nginx в Debian/Ubuntu
    <i class="fa fa-arrow-circle-right"></i>
  </a>
  </span>
  
</div>

  
  
    <div class="section">
    <h2>Comments</h2>
    <div id="disqus_thread"></div>
    <script type="text/javascript">
        var disqus_shortname = 'andrewburdyugblog';
        var disqus_identifier = '/udev-network-rules/';
        var disqus_title = 'Udev Network Rules';
        var disqus_url = 'http://andrewburdyug.github.io/udev-network-rules';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    </div>
  
  </div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../">Blog</a></h1>









  
  
  <h2>
  
  <i class="fa fa-calendar"></i>
    Oct 04, 2013
  
  </h2>

  <ul>
    

  
  <li><i class="fa-fw fa fa-user"></i>
    
      
      <a href="../blog/author/andrew-burdyug/">Andrew Burdyug</a>
      
    </li>
  

  

  

  
  <li><i class="fa-fw fa fa-folder-open"></i>
    
      
      <a href="../blog/category/tricks/">tricks</a>
      
    </li>
  

  
  <li><i class="fa-fw fa fa-tags"></i>
      
    
      
      <a href="../blog/tag/udev/">udev</a>,
      
    
      
      <a href="../blog/tag/archlinux/">archlinux</a>
      
    </li>
  
  
  <li>
    <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'andrewburdyugblog'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = '//' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
    <i class="fa-fw fa fa-comments"></i>
    <a href="#disqus_thread" data-disqus-identifier="/udev-network-rules/"> </a>
  </li>
  
  </ul>


<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/">About me</a></li>
</ul>


  <h3><a href="../blog/">Recent Posts</a></h3>
  <ul>
    
    
      <li><a href="../nginx-build-own-archlinux-package_ru/">May 04 - Сборка Nginx в Archlinux</a></li>
    
      <li><a href="../docker-manage-container-etc-hosts/">Apr 29 - Manage container /etc/hosts</a></li>
    
      <li><a href="../docker-user-defined-networks/">Apr 28 - User defined networks</a></li>
    
      <li><a href="../nginx-try-files-tricks/">Mar 15 - Nginx Try Files Tricks</a></li>
    
      <li><a href="../mysql-innodb-settings-for-ssd/">Sep 28 - Mysql Innodb Settings For SSD</a></li>
    
  </ul>

  <h3><a href="../blog/tag/">Tags</a></h3>
  <style type="text/css">
    ul.ablog-cloud {list-style: none; overflow: auto;}
    ul.ablog-cloud li {float: left; height: 20pt; line-height: 18pt; margin-right: 5px;}
    ul.ablog-cloud a {text-decoration: none; vertical-align: middle;}
    li.ablog-cloud-1{font-size: 80%;}
    li.ablog-cloud-2{font-size: 95%;}
    li.ablog-cloud-3{font-size: 110%;}
    li.ablog-cloud-4{font-size: 125%;}
    li.ablog-cloud-5{font-size: 140%;}
  </style>
  <ul class="ablog-cloud">
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/archlinux/">archlinux</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/debian/">debian</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/docker/">docker</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/git/">git</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/innodb/">innodb</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-3">
        <a href="../blog/tag/mysql/">mysql</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-5">
        <a href="../blog/tag/nginx/">nginx</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/ssd/">ssd</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/udev/">udev</a></li>
      
    
      
      <li class="ablog-cloud ablog-cloud-1">
        <a href="../blog/tag/utf-8/">utf-8</a></li>
      
    
  </ul>

  <h3><a href="../blog/category/">Categories</a></h3>
  <ul>
  
    
    <li><a href="../blog/category/build-package/">build package (2)</a></li>
    
  
    
    <li><a href="../blog/category/tricks/">tricks (2)</a></li>
    
  
    
    <li><a href="../blog/category/tuning/">tuning (1)</a></li>
    
  
  </ul>

  <h3><a href="../blog/archive/">Archives</a></h3>
  <ul>
  
    
    <li><a href="../blog/2016/">2016 (4)</a></li>
    
  
    
    <li><a href="../blog/2014/">2014 (2)</a></li>
    
  
    
    <li><a href="../blog/2013/">2013 (3)</a></li>
    
  
  </ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search/" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Andrew Burdyug.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/udev-network-rules.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-77253587-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    
  </body>
</html>