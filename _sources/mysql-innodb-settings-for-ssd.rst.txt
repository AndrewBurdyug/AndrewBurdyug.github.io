
Mysql Innodb Settings For SSD
=============================

.. post:: Sep 28, 2014
   :tags: mysql, innodb, ssd
   :category: tuning
   :author: Andrew Burdyug

If you have server with SSD hard, you can face the fact that the MySQL very slowly
writes, help these settings adjustment:

.. sourcecode:: ini

    [mysqld]
    innodb_buffer_pool_instances    = 8
    innodb_read_io_threads          = 8
    innodb_write_io_threads         = 8
    innodb_buffer_pool_size         = 64M
    innodb_io_capacity              = 1000
    ; innodb_file_per_table


save this into  ``/etc/mysql/conf.d/tuning.cnf`` and restart MySQL server.
The most important of these settings is ``innodb_io_capacity``,
here what about it says mysql docs:

    The innodb_io_capacity parameter sets an upper limit on the I/O activity
    performed by the InnoDB background tasks, such as flushing pages from the
    buffer pool and merging data from the change buffer. The default value is 200.
    For busy systems capable of higher I/O rates, you can set a higher value at
    server startup, to help the server handle the background maintenance work
    associated with a high rate of row changes.

    The innodb_io_capacity limit is a total limit for all buffer pool instances.
    When dirty pages are flushed, the innodb_io_capacity limit is divided equally
    among buffer pool instances.

    As of MySQL 5.7.2, the innodb_io_capacity setting is also used to limit
    the number of buffer pool load operations per second when there is other I/O
    activity being performed by InnoDB background tasks.

    For systems with individual 5400 RPM or 7200 RPM drives, you might lower the
    value to the former default of 100.

These values were tested on `Linode`_ VM with SSD and 4Gb of RAM.
`Linode`_ ssd servers have a very good performance, here output of ``atop -s 1``
during the converting big database(180 millions of rows) to InnoDb:

.. sourcecode:: console

    DSK |          xvda  | busy     21%  |  read      31  |  write   4306 |  KiB/w     33  |  MBr/s   1.25  |  MBw/s 139.93 |  avio 0.05 ms  |

.. note::
    To convert a non-InnoDB table to use InnoDB use ALTER TABLE:

    .. sourcecode:: sql

        ALTER TABLE table_name ENGINE=InnoDB;

.. _Linode: https://www.linode.com/

.. update:: May 01, 2016

    Added notes about MySQL 5.7.2
